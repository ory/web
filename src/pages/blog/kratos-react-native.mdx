---
path: '/mobile-desktop-app-auth-login-registration-react-native-open-source-guide/'

title: |
  Authentication and Profile Management in React Native Mobile and Desktop Apps

teaser: |
  Implement your own auth, login, registration, user and profile management for native mobile
  and desktop apps using React Native and ORY Kratos Open Source. With code examples in TypeScript
  and Docker.

seo:
  title: |
    Add Auth, Login, Registration to Your Native, Mobile, React Native App
  keywords: |
    login, auth, authentication, registration, react native, native mobile, native desktop,
    open source

publishedAt: '2020-11-20'
author: aeneasr

overline: |
  React Native Authentication
---

import CodeFromRemote from '../../components/codefromremote'
import login from '../../images/articles/react-native/login.png'
import registration from '../../images/articles/react-native/registration.png'
import dashboard from '../../images/articles/react-native/dashboard.png'
import settings from '../../images/articles/react-native/settings.png'

This guide explains step-by-step how to implement login, registration, logout, profile
management, password change, and many other profile-related flows in React
Native using the open source [ORY Kratos](https://www.ory.sh/kratos) project.

<div className="container-fluid">
  <div className="row justify-center-sm">
    <div className="col-sm-3">
      <p>
        <img
          alt="React Native Mobile App with Login using ORY Kratos"
          src={login}
        />
      </p>
    </div>
    <div className="col-sm-3">
      <p>
        <img
          alt="React Native Mobile App with Registration using ORY Kratos"
          src={registration}
        />
      </p>
    </div>
    <div className="col-sm-3">
      <p>
        <img
          alt="React Native Mobile App with User Dashboard using ORY Kratos"
          src={dashboard}
        />
      </p>
    </div>
    <div className="col-sm-3">
      <p>
        <img
          alt="React Native Mobile App with Profile Settings using ORY Kratos"
          src={settings}
        />
      </p>
    </div>
  </div>
</div>

In the future, this guide will also cover Two-Factor-Authentication (2FA/MFA),
"Sign in with Google", password reset, email verification, phone number and SMS
verification, "Sign in with GitHub", "Sign in with Facebook", and many other
flows.

:::note

If you just want to check out the app, download it from the
[Apple App Store](https://apps.apple.com/fj/app/ory-profile-app/id1536546333) or
the [Google Play Store](https://play.google.com/store/apps/details?id=com.ory.kratos_self_service_ui_react_native)! You can also check out the source
code of our
[ORY Kratos React Native reference implementation](https://github.com/ory/kratos-selfservice-ui-react-native).
This guide covers how you would start such a project from scratch.

:::

## Auth, Login, Registration, User Management React Native Template for Expo

This guide assumes that you have worked with React and React Native before as we
will not cover React fundamentals and focus mostly on implementing login,
registration, and so on.

To make things a bit easier, we will use [`expo`](https://expo.io). At minimum,
you need NodeJS and NPM installed locally. We will use the ORY Kratos React
Native Login, Registration, and Profile Management template:

```shell-session
$ npm install -g expo-cli
$ expo init login-signup-app -t @oryd/expo-login-registration-template

# We also want to install and initialize all required components:
$ cd login-signup-app
~/login-signup-app$ npm run expo-install
~/login-signup-app$ npm run pod-install
```

If you want to just start exploring, you can now simply run:

- `npm start` opens a dashboard where you can open iOS, Android, or web.
- `npm run android` opens the app as an android app.
- `npm run ios` opens the app in the iOS simulator.
- `npm run web` opens the app as a browser app.

![Expo CLI Dashboard for ORY Kratos React Native Reference Implementation](../../images/articles/react-native/expo-dashboard.png)

Running these commands directly will use our hosted demo environment of ORY
Kratos at
[demo.tenants.staging.oryapis.dev](https://demo.tenants.staging.oryapis.dev).
This is configured in `app.config.js`:

<CodeFromRemote
  lang="js"
  title="app.config.js"
  src="https://raw.githubusercontent.com/ory/kratos-selfservice-ui-react-native/master/app.config.js"
/>

:::note

If you wish to get your own demo environment, reach out to
[jared@ory.sh](mailto:jared@ory.sh).

:::

The following section will show how to run ORY Kratos on your local machine in Docker instead!

## Run ORY Kratos Login, Registration, 2FA Server in Docker

To run the app against a local deployment, check out
[ORY Kratos](https://www.ory.sh/kratos) locally and run the quickstart:

```shell-session
$ git clone https://github.com/ory/kratos.git
$ cd kratos
$ git checkout v0.5.4-alpha.1
$ docker-compose -f quickstart.yml -f quickstart-standalone.yml \
    up --build --force-recreate -d
```

Next you need a tool like [`ngrok`](https://ngrok.com) to set up port forwarding
for the ORY Kratos Docker Image you just started:

```shell-session
$ ngrok http 4433

Account                       ...
Version                       ...
Region                        ...
Web Interface                 ...
Forwarding                    ...
Forwarding                    https://04ee3e08367a.ngrok.io -> http://localhost:4433

Connections                   ttl     opn     rt1     rt5     p50     p90
                              0       0       0.00    0.00    0.00    0.00
```

Copy the HTTPS forwarding URL (example from above
`https://04ee3e08367a.ngrok.io`) and set it, in a new terminal, as an
environment variable and start the app:

```shell-session
# Change into the directory of your react native app:
$ cd login-signup-app
$ KRATOS_URL=<the-ngrok-url> start
# For example:
# $ export KRATOS_URL=https://04ee3e08367a.ngrok.io
```

Now, your app will use the local deployment of ORY Kratos with your own
database!

## React Native Navigation with Authentication Session

The entrypoint for the app is
[`App.tsx`](https://github.com/ory/kratos-selfservice-ui-react-native/blob/master/App.tsx).
Besides loading some fonts and setting up the views, this component includes the
structure of the application - including the navigation:

<CodeFromRemote
  lang="tsx"
  title="App.tsx"
  startAt="export default"
  src="https://github.com/ory/kratos-selfservice-ui-react-native/blob/master/App.tsx"
/>

The most interesting component here is probably the `<AuthProvider>`. This
component adds an authentication / login context to the React Native component
tree:

<CodeFromRemote
  lang="tsx"
  title="src/components/AuthProvider.tsx"
  startAt="export default"
  src="https://github.com/ory/kratos-selfservice-ui-react-native/blob/master/src/components/AuthProvider.tsx"
/>

The helper methods in
[`src/helpers/auth.tsx`](https://github.com/ory/kratos-selfservice-ui-react-native/blob/master/src/helpers/auth.tsx)
are simple wrappers around Expo's
[SecureStore](https://docs.expo.io/versions/latest/sdk/securestore/). In order
to work on the web as well, we use `@react-native-community/async-storage` as a
fallback:

<CodeFromRemote
  lang="tsx"
  title="src/helpers/auth.tsx"
  startAt="// getAuthenticatedSession"
  src="https://github.com/ory/kratos-selfservice-ui-react-native/blob/master/src/helpers/auth.tsx"
/>

That's all the magic! Everything else is handled by
[ORY Kratos' Session Token](https://www.ory.sh/kratos/docs/guides/login-session).

We now have a place to store and refresh the user session. In addition, we have a way to
see if the user session is still active in the navigation and show the dashboard
or login / registration screens:

<CodeFromRemote
  lang="tsx"
  title="src/components/Navigation.tsx"
  startAt="export default"
  src="https://github.com/ory/kratos-selfservice-ui-react-native/blob/master/src/components/Navigation.tsx#L39-L9999"
/>

## React Native Screens

Let's take a look at the different screens! In order to not write a form
renderer for every component, including styling, we abstracted the form
rendering into their own components, which you can find in
[`src/components/Form`](https://github.com/ory/kratos-selfservice-ui-react-native/tree/master/src/components/Form).

There isn't anything special happening there, but you can have a look if you
intend to change the layout for example.

### Login Navigation Component

The User Login component uses the ORY Kratos TypeScript SDK and the
[User Login API Flow](https://www.ory.sh/kratos/docs/self-service/flows/user-login).

<CodeFromRemote
  lang="tsx"
  title="src/components/Routes/Login.tsx"
  startAt="const Login ="
  src="https://github.com/ory/kratos-selfservice-ui-react-native/blob/master/src/components/Routes/Login.tsx"
/>

### Registration Navigation Component

The User Registration component performs a
[User Registration API Flow](https://www.ory.sh/kratos/docs/self-service/flows/user-registration).

<CodeFromRemote
  lang="tsx"
  title="src/components/Routes/Registration.tsx"
  startAt="const Registration ="
  src="https://github.com/ory/kratos-selfservice-ui-react-native/blob/master/src/components/Routes/Registration.tsx"
/>

### Home Navigation Component

The Home component receives the user's authentication session and displays all
relevant information. To learn more about ORY Kratos' Identity and User
Management check out the
[ORY Kratos Identity Data Model](https://www.ory.sh/kratos/docs/concepts/identity-data-model).

<CodeFromRemote
  lang="tsx"
  title="src/components/Routes/Home.tsx"
  startAt="const Home ="
  src="https://github.com/ory/kratos-selfservice-ui-react-native/blob/master/src/components/Routes/Home.tsx"
/>

### Settings Navigation Component

The User Settings component performs a
[User Settings API Flow](https://www.ory.sh/kratos/docs/self-service/flows/user-settings).

<CodeFromRemote
  lang="tsx"
  title="src/components/Routes/Settings.tsx"
  startAt="const Settings ="
  src="https://github.com/ory/kratos-selfservice-ui-react-native/blob/master/src/components/Routes/Settings.tsx"
/>

## Writing Login and Registration for a React Native App From Scratch

Using a template is the easiest way to get started. If you wish to understand
how everything works however, let's have a look at the project set up process!

Here, we assume that you ran `expo init` with one of the default templates:

```shell-session
$ expo init login-signup-app
```

### React Native Navigation

To set up screen navigation, we use the standard React Native navigation
component:

```shell-session
$ npm add @react-navigation/native @react-navigation/stack
$ expo install react-native-reanimated react-native-gesture-handler react-native-screens react-native-safe-area-context @react-native-community/masked-view
```

### React Native / Expo Encrypted Credentials Storage

We will use
[`expo-secure-store`](https://docs.expo.io/versions/latest/sdk/securestore/) to
securely store the user's session key in the encrypted device store (Android
Keystore / Expo Secure Store). To install it we need to run:

```shell-session
$ expo install expo-secure-store @react-native-community/async-storage
# For iOS you also need to run:
$ npx pod-install
```

We're also adding `@react-native-community/async-storage` as `expo-secure-store`
does not work on the Web.

### ORY Kratos SDKs for React Native

We also need to install the ORY Kratos SDK as well as the ORY Themes package and
some fonts to make the app beautiful:

```shell-session
# The package "url" is needed as it is not natively available in React Native.
$ npm install @oryd/kratos-client@0.5.4-alpha.1 url
```

### React Native Environment Variable Support

Next we want to set up support for environment variables which we will be using
in the next section. You can either
[follow the Expo guide on Environment Variables](https://docs.expo.io/guides/environment-variables/#using-babel-to-replace-variables)
or do the following:

```shell-session
$ expo install expo-constants
```

Create a file called `app.config.js` in the project's root:

<CodeFromRemote
  lang="js"
  title="app.config.js"
  src="https://github.com/ory/kratos-selfservice-ui-react-native/blob/master/app.config.js"
/>

You can use this variable when initializing the ORY Kratos SDK:

<CodeFromRemote
  lang="tsx"
  title="src/helpers/sdk.tsx"
  src="https://github.com/ory/kratos-selfservice-ui-react-native/blob/master/src/helpers/sdk.tsx"
/>

### Fonts and Other Dependencies

To make things a bit prettier, we are going to add some fonts and the
[ORY Theme](https://github.com/ory/themes):

```shell-session
$ npm install @oryd/themes styled-components
$ expo install expo font @expo-google-fonts/rubik \
    @expo-google-fonts/roboto expo-status-bar
```

You are of course free to use your own themes here but for the sake of
completeness we added this to the guide.
