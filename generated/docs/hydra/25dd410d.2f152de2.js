(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{129:function(e,t,r){"use strict";r.r(t),r.d(t,"frontMatter",(function(){return o})),r.d(t,"metadata",(function(){return c})),r.d(t,"rightToc",(function(){return s})),r.d(t,"default",(function(){return d}));var n=r(2),a=r(6),i=(r(0),r(472)),o={id:"migrating-from-MITREid",title:"Migrating from MITREid"},c={unversionedId:"guides/migrating-from-MITREid",id:"version-v1.9/guides/migrating-from-MITREid",isDocsHomePage:!1,title:"Migrating from MITREid",description:"Please note this page doesn't pretend to be a step-by-step guide.",source:"@site/versioned_docs/version-v1.9/guides/migrating-from-mitreid.mdx",slug:"/guides/migrating-from-MITREid",permalink:"/hydra/docs/guides/migrating-from-MITREid",editUrl:"https://github.com/ory/hydra/edit/master/docs/versioned_docs/version-v1.9/guides/migrating-from-mitreid.mdx",version:"v1.9",lastUpdatedBy:"Bernat Mut",lastUpdatedAt:1603980380},s=[],p={rightToc:s};function d(e){var t=e.components,r=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},p,r,{components:t,mdxType:"MDXLayout"}),Object(i.b)("div",{className:"admonition admonition-info alert alert--info"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"info")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"Please note this page doesn't pretend to be a step-by-step guide."))),Object(i.b)("p",null,"This piece of documentation will try to give you some hints to move your current MITREid instance to Hydra. "),Object(i.b)("h4",{id:"scopes"},"Scopes"),Object(i.b)("p",null,"Scopes in hydra doesn't have a relational entity, every client defines its own array of scopes."),Object(i.b)("h4",{id:"scope-vs-scp"},"Scope vs Scp"),Object(i.b)("p",null,"Since hydra uses scp as the scope claim, you have to be sure your client libraries are capable to use both, we had to modify the behavior of our version of spring.security.oauth2 library following the example: ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://dev.to/toojannarong/spring-security-with-jwt-the-easiest-way-2i43"}),"Custom claim")),Object(i.b)("h4",{id:"query-string-parameters"},"Query String Parameters"),Object(i.b)("p",null,"MITREid doesn't mind if the parameters are passed in the body or in the query string. In order to work with hydra, you have to migrate all your calls that are using QS params to Body Parameters."),Object(i.b)("p",null,"For example, you should move from",Object(i.b)("br",{parentName:"p"}),"\n","`","``\ncurl -X POST  ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"http://127.0.0.1/mitreid-server/token?grant_type=client_credentials"}),"http://127.0.0.1/mitreid-server/token?grant_type=client_credentials"),' -H "Authorization: $AUTH" ...\n',"`","``"),Object(i.b)("p",null,"to"),Object(i.b)("p",null,"`","``\ncurl -X POST  ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"http://127.0.0.1/mitreid-server/token"}),"http://127.0.0.1/mitreid-server/token")," -H \"Authorization: $AUTH\" --data-urlencode 'grant_type=client_credentials' ...\n","`","``"),Object(i.b)("h4",{id:"scope-strategies-if-no-scope-is-requested"},"Scope Strategies if no scope is requested"),Object(i.b)("p",null,"The last pitfall found during the migration was the difference of behavior when you request a ",Object(i.b)("em",{parentName:"p"},"client_credentials")," token and you don't specify any token,\nby default hydra doesn't return any scope but MITREid returns all associated scopes to the client. To enable this in hydra, you have set up the env variable ",Object(i.b)("em",{parentName:"p"},"OAUTH2_CLIENT_CREDENTIALS_DEFAULT_GRANT_SCOPE=true"),",\nafter enable this capability hydra will start serving all the scopes assigned to this client "))}d.isMDXComponent=!0},472:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return m}));var n=r(0),a=r.n(n);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var p=a.a.createContext({}),d=function(e){var t=a.a.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):c(c({},t),e)),r},l=function(e){var t=d(e.components);return a.a.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},b=a.a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,i=e.originalType,o=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),l=d(r),b=n,m=l["".concat(o,".").concat(b)]||l[b]||u[b]||i;return r?a.a.createElement(m,c(c({ref:t},p),{},{components:r})):a.a.createElement(m,c({ref:t},p))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=r.length,o=new Array(i);o[0]=b;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:n,o[1]=c;for(var p=2;p<i;p++)o[p]=r[p];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,r)}b.displayName="MDXCreateElement"}}]);