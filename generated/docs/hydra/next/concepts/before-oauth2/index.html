<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.58">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-71865250-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="ORY Hydra" href="/hydra/docs/opensearch.xml"><title data-react-helmet="true">Read This Before Becoming an OAuth2 or OpenID Connect Provider! | ORY Hydra</title><meta data-react-helmet="true" name="docsearch:version" content="next"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Read This Before Becoming an OAuth2 or OpenID Connect Provider! | ORY Hydra"><meta data-react-helmet="true" name="description" content="OAuth2 and OpenID Connect is all the rage with big platforms (Google, Facebook,"><meta data-react-helmet="true" property="og:description" content="OAuth2 and OpenID Connect is all the rage with big platforms (Google, Facebook,"><meta data-react-helmet="true" property="og:url" content="https://www.ory.sh//hydra/docs/next/concepts/before-oauth2"><link data-react-helmet="true" rel="shortcut icon" href="/hydra/docs/img/favico.png"><link data-react-helmet="true" rel="canonical" href="https://www.ory.sh//hydra/docs/next/concepts/before-oauth2"><link rel="stylesheet" href="/hydra/docs/styles.d6f5c0dd.css">
<link rel="preload" href="/hydra/docs/styles.0cdc8d31.js" as="script">
<link rel="preload" href="/hydra/docs/runtime~main.b1aad6d4.js" as="script">
<link rel="preload" href="/hydra/docs/main.e4e70237.js" as="script">
<link rel="preload" href="/hydra/docs/2.76ec1d16.js" as="script">
<link rel="preload" href="/hydra/docs/3.06d6bfd4.js" as="script">
<link rel="preload" href="/hydra/docs/18b93cb3.84ecaa11.js" as="script">
<link rel="preload" href="/hydra/docs/1be78505.07e0af65.js" as="script">
<link rel="preload" href="/hydra/docs/f9e517e8.5ef17571.js" as="script">
<link rel="preload" href="/hydra/docs/155.753a528e.js" as="script">
<link rel="preload" href="/hydra/docs/154.3ba2b49d.js" as="script">
<link rel="preload" href="/hydra/docs/71bd2d01.e68937ca.js" as="script">
<link rel="preload" href="/hydra/docs/17896441.53a219b5.js" as="script">
<link rel="preload" href="/hydra/docs/a8c75ac8.0e0cbad5.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a href="https://www.ory.sh/hydra" target="_blank" rel="noopener noreferrer" class="navbar__brand" to="https://www.ory.sh/hydra"><img class="navbar__logo" src="/hydra/docs/img/logo-hydra.svg" alt="ORY Hydra"></a><a class="navbar__item navbar__link" href="/hydra/docs/index">Docs</a><a href="https://www.ory.sh/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Ecosystem</a><a href="https://www.ory.sh/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a><a href="https://community.ory.sh" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Forum</a><a href="https://www.ory.sh/chat" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chat</a><a href="https://github.com/ory/hydra" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/hydra/docs/versions">v1.6</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><div class="searchWrapper_-F3-"><span aria-label="expand searchbar" role="button" class="searchIconButton_1Dnz" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_2eto"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a href="https://www.ory.sh/hydra" target="_blank" rel="noopener noreferrer" class="navbar__brand" to="https://www.ory.sh/hydra"><img class="navbar__logo" src="/hydra/docs/img/logo-hydra.svg" alt="ORY Hydra"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/hydra/docs/index">Docs</a></li><li class="menu__list-item"><a href="https://www.ory.sh/docs" target="_blank" rel="noopener noreferrer" class="menu__link">Ecosystem</a></li><li class="menu__list-item"><a href="https://www.ory.sh/blog" target="_blank" rel="noopener noreferrer" class="menu__link">Blog</a></li><li class="menu__list-item"><a href="https://community.ory.sh" target="_blank" rel="noopener noreferrer" class="menu__link">Forum</a></li><li class="menu__list-item"><a href="https://www.ory.sh/chat" target="_blank" rel="noopener noreferrer" class="menu__link">Chat</a></li><li class="menu__list-item"><a href="https://github.com/ory/hydra" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a class="menu__link" href="/hydra/docs/versions">v1.6</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp" role="complementary"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/5min-tutorial">5 Minute Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/install">Installation</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/hydra/docs/next/concepts/before-oauth2">Read This Before Becoming an OAuth2 or OpenID Connect Provider!</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/hydra/docs/next/concepts/oauth2">OAuth 2.0</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/hydra/docs/next/concepts/openid-connect-oidc">OpenID Connect</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/hydra/docs/next/concepts/login">Login Flow</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/hydra/docs/next/concepts/consent">Consent Flow</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/hydra/docs/next/concepts/logout">Logout Flow</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/hydra/docs/next/jwks">JSON Web Key Sets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/hydra/docs/next/limitations">Limitations</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Implementing the User Interface</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/guides/login">Login Endpoint</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/guides/consent">Consent Endpoint</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/guides/logout">Logout Endpoint</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Operations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/configure-deploy">Run ORY Hydra in Docker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/dependencies-environment">Database Setup and Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/production">Preparing for Production</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/guides/tracing">Distributed Tracing with Jaeger</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/guides/secrets-key-rotation">Secrets and Key Rotation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/guides/kubernetes-helm-chart">Kubernetes Helm Chart</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/guides/ssl-https-tls">SSL/TLS, HTTPS, Self-Signed Certificates</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/guides/cookies">Configuring Cookies</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/guides/scaling-hydra">Scaling ORY Hydra</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/guides/cors">Setting up Cross-origin resource sharing (CORS)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">OAuth2 &amp; OpenID Connect</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/advanced">Advanced OAuth2 and OpenID Connect Flows</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/guides/oauth2-clients">Creating OAuth 2.0 Clients</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/guides/common-oauth2-openid-connect-flows">Using Common OAuth2 and OpenID Connect Flows</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/guides/using-oauth2">Using OAuth2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/guides/oauth2-token-introspection">OAuth 2.0 Token Introspection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/guides/oauth2-public-spa-mobile">Mobile &amp; Browser (Single-Page-App) with OAuth2</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/reference/configuration">Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/reference/api">REST API</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Debug &amp; Help</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/debug">Common Problem Solutions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/debug/csrf">Common CSRF Pitfalls</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/debug/token-endpoint-auth-method">Wrong Token Endpoint Auth Method</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/debug/logout">Logout not Working as Expected</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">SDKs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/sdk">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/sdk/go">Go</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/sdk/js">JavaScript</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/sdk/php">PHP</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Further Reading</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/case-study">OAuth 2.0 Case Study</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/benchmark">Benchmarks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/security-architecture">Security Architecture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hydra/docs/next/faq">FAQ</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ORY Kratos</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/kratos" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://www.ory.sh/kratos" tabindex="-1">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/kratos/docs" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://www.ory.sh/kratos/docs" tabindex="-1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/ory/kratos" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://github.com/ory/kratos" tabindex="-1">GitHub</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ORY Oathkeeper</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/oathkeeper" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://www.ory.sh/oathkeeper" tabindex="-1">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/oathkeeper/docs" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://www.ory.sh/oathkeeper/docs" tabindex="-1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/ory/oathkeeper" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://github.com/ory/oathkeeper" tabindex="-1">GitHub</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ORY Keto</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/keto" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://www.ory.sh/keto" tabindex="-1">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/keto/docs" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://www.ory.sh/keto/docs" tabindex="-1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/ory/keto" target="_blank" rel="noreferrer noopener" class="menu__link" to="https://github.com/ory/keto" tabindex="-1">GitHub</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for ORY Hydra <strong>next</strong> version.</div><div class="margin-top--md">For up-to-date documentation, see the <strong><a href="/hydra/docs">latest version</a></strong>.</div></div><div class="docItemContainer_2cwg"><article><div><span class="badge badge--secondary">Version: next</span></div><header><h1 class="docTitle_1vWb">Read This Before Becoming an OAuth2 or OpenID Connect Provider!</h1></header><div class="markdown"><p>OAuth2 and OpenID Connect is all the rage with big platforms (Google, Facebook,
GitHub) and identity SaaS products (Okta, Auth0) which is why you probably ended
up at ORY Hydra. But before you start hacking away, the best use of your time
right now is to re-evaluate if you really need OAuth2 and OpenID Connect.</p><p>To do so, we will cover common misunderstandings and misconceptions about OAuth2
in this document and guidance on what to do instead!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="what-its-good-for"></a>What it&#x27;s Good for<a aria-hidden="true" tabindex="-1" class="hash-link" href="#what-its-good-for" title="Direct link to heading">#</a></h2><p>If you are like GitHub and you want to enable people not associated with your
company like CircleCi or TravisCI to have access to your user&#x27;s data, ORY Hydra
is the right tool for you.</p><p>If you want apps and websites you don&#x27;t own to use your application as a
potential sign in (e.g. be listed alongside &quot;Sign in with Google&quot;, &quot;Sign in with
Apple&quot;), ORY Hydra is the right tool for you.</p><p>If you use an API that works with OAuth2 or OpenID Connect, then of course you
need to use that API - but then you are on the OAuth2 / OpenID Connect client
side!</p><p>If you do not have user registration, password recovery, login form, session
management, or user settings system in place then OAuth2 is most likely not the
right fit for you. If that&#x27;s the case, check out
<a href="https://www.ory.sh/kratos/" target="_blank" rel="noopener noreferrer">ORY Kratos</a>!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="oauth2-and-openid-connect-do-not-solve-registration-password-reset-"></a>OAuth2 and OpenID Connect do not Solve Registration, Password Reset, ...<a aria-hidden="true" tabindex="-1" class="hash-link" href="#oauth2-and-openid-connect-do-not-solve-registration-password-reset-" title="Direct link to heading">#</a></h2><p>OAuth2 and OpenID Connect are so-called delegation protocols which are not
concerned with user registration, password recovery, changing a password or
email address and so on.</p><p>Actually, OAuth2 and OpenID Connect do not even specify how your users sign in
(email and password? username and password? passwordless? sms 2fa?), they only
establish that <strong>you need a method for users to sign in</strong>.</p><p>If you are wondering what password hashing algorithm to use, or how your users
sign up for your platform, then you don&#x27;t need OAuth2 or OpenID Connect right
now. Instead, you should give <a href="https://www.ory.sh/kratos/" target="_blank" rel="noopener noreferrer">ORY Kratos</a> a spin,
which aims to solve exactly that.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="access-and-refresh-tokens-are-not-sessions"></a>Access and Refresh Tokens are not Sessions!<a aria-hidden="true" tabindex="-1" class="hash-link" href="#access-and-refresh-tokens-are-not-sessions" title="Direct link to heading">#</a></h2><p>With OAuth2 and OpenID Connect you end up with three session layers:</p><ul><li>Your <strong>Application&#x27;s Session Manager</strong> keeps track of the user within your
application. You will use OpenID Connect to initiate and complete the login,
but your application needs to store and track and invalidate the session.</li><li>ORY Hydra maintains a session cookie. When a user signs in, the cookie will be
set for that user. This allows the next OAuth2 request to complete without
requesting the user to sign in again.</li><li>Optionally - If your application connects to a third-party identity provider
(e.g. Sign in with Google, GitHub, Facebook, ...) that third party provider
also maintains a session of the user.</li></ul><p>A common misconception is that access and refresh tokens represent a user
session. <strong>They do not.</strong></p><p>Let&#x27;s take a look at a common example: CircleCI/TravisCI/... and GitHub. To use
CircleCI or TravisCI or similar products, they usually prompt you to sign into
GitHub because they need access to your repositories. Once access is granted,
CircleCI creates a new user account in their database and generates a session
cookie (see Application Session Manager above). If you now sign out of GitHub,
you will make two observations:</p><ol><li>CircleCI still has access to your repositories;</li><li>You are still logged into CircleCI.</li></ol><p>If you instead sign out of CircleCI:</p><ol><li>CircleCI still has access to your repositories;</li><li>You are still logged into GitHub.</li></ol><p>That is because both applications are built by different people and different
companies, and the user behavior on one site does not reflect user intent on
another. It would be crazy if some app could just log you out of GitHub, or if
signing out of Google would invalidate your sessions on all the websites where
you used &quot;Sign in with Google&quot;.</p><p>Access and refresh tokens allow developers you do not know to do things in your
application in the name of your users over a prolonged period of time. CircleCI
uses access tokens to watch your repositories for changes, update status checks
on pull requests, using access and refresh tokens. These tokens are valid for as
long as you don&#x27;t remove CircleCI from your GitHub account. Logout does not
change any of that.</p><p>If you want to read up on this more, check out
<a href="https://dzone.com/articles/oauth-20-vs-session-management" target="_blank" rel="noopener noreferrer">OAuth 2.0 vs Session Management</a>.</p><p>Now you should be at a point where</p><ol><li>you realize that you only want to solve sign up, login, session management
and that you don&#x27;t need OAuth2 - your next step in this case should be to
check out <a href="https://www.ory.sh/kratos/" target="_blank" rel="noopener noreferrer">ORY Kratos</a> which does solve all of
that;</li><li>you are reaffirmed that you need OAuth2 and OpenID connect because you want
developers you don&#x27;t know to interact with your users and your users&#x27; data -
in which case ORY Hydra is a great fit for you!</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="but-googlefacebook-use-oauth2-and-openid-connect"></a>&quot;But Google/Facebook/... use OAuth2 and OpenID Connect&quot;<a aria-hidden="true" tabindex="-1" class="hash-link" href="#but-googlefacebook-use-oauth2-and-openid-connect" title="Direct link to heading">#</a></h2><p>Have you ever wondered why, when signing into Google/Facebook/Twitter/...</p><ul><li>you don&#x27;t see a screen asking you to grant permission (&quot;Do you want to allow
... to access your ...?&quot;)?</li><li>their mobile app does not open a browser window or use an embedded WebView?</li><li>your browser doesn&#x27;t perform tons of redirects?</li></ul><p>The answer is quite simple - they do not use OAuth2 or OpenID Connect for login
and session management in first-party scenarios. It goes even further than
that - for example YouTube, which runs on a separate domain - does not use
OAuth2 to sign into your Google account. They use a proprietary flow that
includes HTTP Cookies.</p><p>However, OAuth2 and OpenID Connect do get used in certain scenarios at these
companies:</p><ul><li>The Google Cloud SDK CLI uses OAuth2 to sign into your Google Cloud account;</li><li>FireStick uses the OAuth2 Device Authorization grant to log you into your
Amazon account;</li><li>GitHub does offer an API to third-party developers that involves OAuth2.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="but-saas-identity-products-use-oauth2-and-openid-connect"></a>&quot;But SaaS Identity Products use OAuth2 and OpenID Connect&quot;<a aria-hidden="true" tabindex="-1" class="hash-link" href="#but-saas-identity-products-use-oauth2-and-openid-connect" title="Direct link to heading">#</a></h2><p>They do, and they have great SDKs to help you avoid a lot of the OAuth2 and
OpenID Complexity until you hit the very core limitations of OAuth2 which are
amongst others:</p><ul><li>Up to three different session states (see e.g.
<a href="https://auth0.com/docs/sessions/concepts/session-layers" target="_blank" rel="noopener noreferrer">Auth0 Session Layers</a>);</li><li>Multi-stage logout flows (see e.g.
<a href="https://auth0.com/docs/quickstart/webapp/nodejs" target="_blank" rel="noopener noreferrer">Auth0 Logout on NodeJS</a>,
<a href="https://auth0.com/docs/tokens/guides/revoke-tokens" target="_blank" rel="noopener noreferrer">Revoke Tokens on Auth0</a>);</li><li>Logout does not invalidate access tokens (see e.g.
<a href="https://auth0.com/docs/logout" target="_blank" rel="noopener noreferrer">Auth0 Logout</a>);</li><li>Complex integration with Social Sign In (e.g. Twitter, Facebook, ...) on
native mobile apps (see e.g.
<a href="https://auth0.com/docs/quickstart/native/ios-swift-facebook-login#before-you-start" target="_blank" rel="noopener noreferrer">iOS Swift - Facebook Login</a>).</li></ul><p>We picked Auth0 docs a lot because they explain the caveats of using OAuth2 and
OpenID Connect well. These limitations apply to all software (e.g. ORY Hydra,
Okta, Keycloak, ...) that use OAuth2 and OpenID Connect as their primary
protocols.</p><p>If all you need is user registration, log in, user settings, and similar flows -
check out <a href="https://www.ory.sh/kratos/" target="_blank" rel="noopener noreferrer">ORY Kratos</a>!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="you-must-ensure-secure-storage-of-access-and-refresh-tokens"></a>You must Ensure Secure Storage of Access and Refresh Tokens<a aria-hidden="true" tabindex="-1" class="hash-link" href="#you-must-ensure-secure-storage-of-access-and-refresh-tokens" title="Direct link to heading">#</a></h2><p>Storing access and refresh tokens involves tradeoffs:</p><ul><li>Storing tokens in the Browser&#x27;s <code>localStorage</code> or JavaScript cookies is easy,
but you become highly vulnerable to XSS Attacks;</li><li>Storing tokens in a <code>httpOnly</code> cookie is more secure but means that you need a
server-side component which performs the OAuth2 flows and then stores the
tokens in an encrypted cookie;</li><li>Storing tokens in a database is secure but implies a lot of overhead.</li></ul><p>On top of that, you need to refresh tokens when they expire which may become
very complex in scenarios where you have more than one HTTP request using the
access token. This is especially true for systems that have refresh tokens which
are valid for one use only (e.g. ORY Hydra, Auth0, ...).</p><p><strong>Cookies are great</strong> and a common misconception is that cookies are less secure
than tokens or less usable. For 95% of web applications it is enough to work
with cookies, especially if they only run in the browser and not in a native
mobile app. And that&#x27;s great, because the browser takes care of:</p><ul><li>Bound to one top-level-domain only;</li><li>Anti-XSS with <code>httpOnly</code></li><li>TLS enforcment with <code>secure</code>;</li><li>Smaller CSRF attack surface with the new <code>SameSite</code> directive;</li><li>The domain model (cookies are isolated per domain);</li></ul><p><a href="https://www.ory.sh/kratos/" target="_blank" rel="noopener noreferrer">ORY Kratos</a> works both with tokens and cookies.
Implementing login does not involve any manual token handling - just log in and
you&#x27;re done!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="access-token-scope-is-not-an-access-control-permission"></a>Access Token Scope is not an Access Control Permission<a aria-hidden="true" tabindex="-1" class="hash-link" href="#access-token-scope-is-not-an-access-control-permission" title="Direct link to heading">#</a></h2><p>The OAuth 2.0 Scope <strong>is not an internal RBAC/ACL permission</strong>:</p><ul><li>A permission allows an actor to perform a certain action in a system: <em>Bob is
allowed to delete his own photos</em>.</li><li>OAuth 2.0 Scope implies that an end-user granted certain privileges to a
client: <em>Bob allowed the OAuth 2.0 Client to delete all users</em>. But Bob might
not be allowed to delete all users because Bob is not an admin.</li></ul><p>The OAuth 2.0 Scope can be granted without the end-user actually having the
right permissions. In the examples above, Bob granted an OAuth 2.0 Client the
permission (&quot;scope&quot;) to delete all users in his name. However, since Bob is not
an administrator, that permission (&quot;access control&quot;) is not actually granted to
Bob. Therefore any request by the OAuth 2.0 Client that tries to delete users on
behalf of Bob should fail.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/ory/hydra/edit/master/docs/docs/concepts/before-oauth2.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-08-03T09:09:25.000Z" class="docLastUpdatedAt_1sqk">8/3/2020</time> by <strong>Vincent</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/hydra/docs/next/install"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Installation</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/hydra/docs/next/concepts/oauth2"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">OAuth 2.0 »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-its-good-for" class="table-of-contents__link">What it&#39;s Good for</a></li><li><a href="#oauth2-and-openid-connect-do-not-solve-registration-password-reset-" class="table-of-contents__link">OAuth2 and OpenID Connect do not Solve Registration, Password Reset, ...</a></li><li><a href="#access-and-refresh-tokens-are-not-sessions" class="table-of-contents__link">Access and Refresh Tokens are not Sessions!</a></li><li><a href="#but-googlefacebook-use-oauth2-and-openid-connect" class="table-of-contents__link">&quot;But Google/Facebook/... use OAuth2 and OpenID Connect&quot;</a></li><li><a href="#but-saas-identity-products-use-oauth2-and-openid-connect" class="table-of-contents__link">&quot;But SaaS Identity Products use OAuth2 and OpenID Connect&quot;</a></li><li><a href="#you-must-ensure-secure-storage-of-access-and-refresh-tokens" class="table-of-contents__link">You must Ensure Secure Storage of Access and Refresh Tokens</a></li><li><a href="#access-token-scope-is-not-an-access-control-permission" class="table-of-contents__link">Access Token Scope is not an Access Control Permission</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Company</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.ory.sh/imprint" target="_blank" rel="noopener noreferrer" class="footer__link-item">Imprint</a></li><li class="footer__item"><a href="https://www.ory.sh/privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://www.ory.sh/tos" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li></ul></div></div><div class="text--center"><div>Copyright © 2020 ORY GmbH</div></div></div><div id="codefund"></div><script src="https://codefund.io/properties/140/funder.js" async=""></script><script>document.querySelectorAll(".tabs .tabs-nav .nav-item a").forEach((function(t){t.addEventListener("click",(function(e){return e.preventDefault(),t.closest(".tabs-nav").querySelectorAll(".nav-item a").forEach((function(t){t.classList.remove("active")})),t.closest(".tabs").querySelectorAll(".tab-content .tab-pane").forEach((function(t){t.classList.remove("active")})),t.classList.add("active"),document.getElementById(t.href.split("#")[1]).classList.add("active"),!1}))}))</script></footer></div>
<script src="/hydra/docs/styles.0cdc8d31.js"></script>
<script src="/hydra/docs/runtime~main.b1aad6d4.js"></script>
<script src="/hydra/docs/main.e4e70237.js"></script>
<script src="/hydra/docs/2.76ec1d16.js"></script>
<script src="/hydra/docs/3.06d6bfd4.js"></script>
<script src="/hydra/docs/18b93cb3.84ecaa11.js"></script>
<script src="/hydra/docs/1be78505.07e0af65.js"></script>
<script src="/hydra/docs/f9e517e8.5ef17571.js"></script>
<script src="/hydra/docs/155.753a528e.js"></script>
<script src="/hydra/docs/154.3ba2b49d.js"></script>
<script src="/hydra/docs/71bd2d01.e68937ca.js"></script>
<script src="/hydra/docs/17896441.53a219b5.js"></script>
<script src="/hydra/docs/a8c75ac8.0e0cbad5.js"></script>
</body>
</html>