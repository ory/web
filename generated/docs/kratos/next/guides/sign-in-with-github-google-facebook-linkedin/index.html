<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.415a7973f">
<script>var _paq=window._paq=window._paq||[];_paq.push(["setDocumentTitle",document.domain+"/"+document.title]),_paq.push(["setCookieDomain","*.ory.sh"]),_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var e="//sqa-web.ory.sh/";_paq.push(["setTrackerUrl",e+"np.php"]),_paq.push(["setSiteId","2"]);var a=document,p=a.createElement("script"),t=a.getElementsByTagName("script")[0];p.type="text/javascript",p.async=!0,p.src=e+"js/np.js",t.parentNode.insertBefore(p,t)}()</script>
<link rel="search" type="application/opensearchdescription+xml" title="ORY Kratos" href="/kratos/docs/opensearch.xml"><title data-react-helmet="true">Sign in with GitHub, GitLab, Google, Facebook, LinkedIn, Microsoft ... | ORY Kratos</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Sign in with GitHub, GitLab, Google, Facebook, LinkedIn, Microsoft ... | ORY Kratos"><meta data-react-helmet="true" name="description" content="In this document we will take a look at setting up &quot;Sign in with GitHub&quot; using"><meta data-react-helmet="true" property="og:description" content="In this document we will take a look at setting up &quot;Sign in with GitHub&quot; using"><meta data-react-helmet="true" property="og:url" content="https://www.ory.sh//kratos/docs/next/guides/sign-in-with-github-google-facebook-linkedin"><link data-react-helmet="true" rel="shortcut icon" href="/kratos/docs/img/favico.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://www.ory.sh//kratos/docs/next/guides/sign-in-with-github-google-facebook-linkedin"><link rel="stylesheet" href="/kratos/docs/styles.28751f83.css">
<link rel="preload" href="/kratos/docs/styles.f323bf4b.js" as="script">
<link rel="preload" href="/kratos/docs/runtime~main.19a413eb.js" as="script">
<link rel="preload" href="/kratos/docs/main.001eb6bc.js" as="script">
<link rel="preload" href="/kratos/docs/2.23b0993d.js" as="script">
<link rel="preload" href="/kratos/docs/3.534471af.js" as="script">
<link rel="preload" href="/kratos/docs/18b93cb3.ba3604b6.js" as="script">
<link rel="preload" href="/kratos/docs/1be78505.d49740a9.js" as="script">
<link rel="preload" href="/kratos/docs/375.1a250f46.js" as="script">
<link rel="preload" href="/kratos/docs/b8d7c5e6.387dfc0a.js" as="script">
<link rel="preload" href="/kratos/docs/935f2afb.21b0d5f6.js" as="script">
<link rel="preload" href="/kratos/docs/374.add71109.js" as="script">
<link rel="preload" href="/kratos/docs/1997122c.b72ffe89.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top navbarHideable_17Wu navbarHidden_19ww"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a href="https://www.ory.sh/kratos" target="_blank" rel="noopener noreferrer" class="navbar__brand"><img src="/kratos/docs/img/logo-kratos.svg" alt="ORY Kratos" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/kratos/docs/img/logo-kratos.svg" alt="ORY Kratos" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/kratos/docs/">Docs</a><a href="https://www.ory.sh/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Ecosystem</a><a href="https://www.ory.sh/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a><a href="https://github.com/ory/${githubRepoName}/discussions" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discussions</a><a href="https://www.ory.sh/chat" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chat</a><a href="https://github.com/ory/kratos" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link" href="/kratos/docs/next/">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/kratos/docs/next/guides/sign-in-with-github-google-facebook-linkedin">Next</a></li><li><a class="dropdown__link" href="/kratos/docs/guides/sign-in-with-github-google-facebook-linkedin">v0.5</a></li><li><a class="dropdown__link" href="/kratos/docs/v0.4/guides/sign-in-with-github-google-facebook-linkedin">v0.4</a></li><li><a class="dropdown__link" href="/kratos/docs/v0.3/guides/sign-in-with-github-google-facebook-linkedin">v0.3</a></li><li><a class="dropdown__link" href="/kratos/docs/v0.2/">v0.2</a></li><li><a class="dropdown__link" href="/kratos/docs/v0.1/">v0.1</a></li><li><a class="dropdown__link" href="/kratos/docs/versions">All versions</a></li></ul></div><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><div class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></div></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a href="https://www.ory.sh/kratos" target="_blank" rel="noopener noreferrer" class="navbar__brand"><img src="/kratos/docs/img/logo-kratos.svg" alt="ORY Kratos" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/kratos/docs/img/logo-kratos.svg" alt="ORY Kratos" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/kratos/docs/">Docs</a></li><li class="menu__list-item"><a href="https://www.ory.sh/docs" target="_blank" rel="noopener noreferrer" class="menu__link">Ecosystem</a></li><li class="menu__list-item"><a href="https://www.ory.sh/blog" target="_blank" rel="noopener noreferrer" class="menu__link">Blog</a></li><li class="menu__list-item"><a href="https://github.com/ory/${githubRepoName}/discussions" target="_blank" rel="noopener noreferrer" class="menu__link">Discussions</a></li><li class="menu__list-item"><a href="https://www.ory.sh/chat" target="_blank" rel="noopener noreferrer" class="menu__link">Chat</a></li><li class="menu__list-item"><a href="https://github.com/ory/kratos" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/kratos/docs/next/guides/sign-in-with-github-google-facebook-linkedin">Next</a></li><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/guides/sign-in-with-github-google-facebook-linkedin">v0.5</a></li><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/v0.4/guides/sign-in-with-github-google-facebook-linkedin">v0.4</a></li><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/v0.3/guides/sign-in-with-github-google-facebook-linkedin">v0.3</a></li><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/v0.2/">v0.2</a></li><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/v0.1/">v0.1</a></li><li class="menu__list-item"><a class="menu__link" href="/kratos/docs/versions">All versions</a></li></ul></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy sidebarWithHideableNavbar_CROi"><a href="https://www.ory.sh/kratos" target="_blank" rel="noopener noreferrer" tabindex="-1" class="sidebarLogo_xFc8"><img src="/kratos/docs/img/logo-kratos.svg" alt="ORY Kratos" class="themedImage_YANc themedImage--light_3CMI"><img src="/kratos/docs/img/logo-kratos.svg" alt="ORY Kratos" class="themedImage_YANc themedImage--dark_3ARp"></a><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/quickstart">Quickstart</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/install">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/configuring">Configuring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/contributing">Contribution Guidelines</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/faq">Frequently Asked Questions (FAQ)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/concepts/index">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/concepts/terminology">Terminology</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/concepts/ui-user-interface">User Interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/concepts/identity-data-model">Identity Data Model</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Identity Credentials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/concepts/credentials">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/concepts/credentials/username-email-password">Username / Email &amp; Password</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/concepts/credentials/openid-connect-oidc-oauth2">Social Sign In, OpenID Connect, and OAuth2</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/concepts/browser-redirect-flow-completion">HTTP Redirection Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/concepts/email-sms">Out-of-band communication via E-Mail and SMS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/concepts/rest-api">REST API Design</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/concepts/federation">Federation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/concepts/security">Threat Models and Security Profiles</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Self Service (End-User)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service">Concepts and Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service/flows/user-registration">User Registration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service/flows/user-login">User Login</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service/flows/user-settings">User Settings and Profile Updates</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service/flows/account-recovery">Account Recovery and Password Reset</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service/flows/verify-email-account-activation">Email and Phone Verification and Account Activation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service/flows/user-logout">User Logout</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service/flows/user-facing-errors">User-Facing Errors</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service/flows/2fa-mfa-multi-factor-authentication">MFA / 2FA</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/self-service/hooks">Hooks</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Administration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/admin/managing-users-identities">Managing Users and Identities</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/kratos/docs/next/guides/sign-in-with-github-google-facebook-linkedin">Sign in with GitHub, GitLab, Google, Facebook, LinkedIn, Microsoft ...</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/guides/login-session">Configuring And Checking for Login Sessions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/guides/configuring-cookies">Configuring Cookies</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/guides/multi-domain-cookies">Getting URLs and Cookies to Work on Multi-Domains</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/guides/setting-up-cors">Setting up Cross-origin resource sharing (CORS)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/guides/account-recovery-password-reset">Setting up Account Recovery and Password Reset</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/guides/account-activation-email-verification">Setting up Account Activation and E-Mail Verification</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/guides/zero-trust-iap-proxy-identity-access-proxy">Zero Trust with IAP Proxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/guides/multi-tenancy-multitenant">Multitenancy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/guides/secret-key-rotation">Secret and Key Rotation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/guides/high-availability-ha">High Availability</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/guides/docker">Docker Images</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kratos/docs/next/guides/setting-up-password-hashing-parameters">Setting up Password Hashing Parameters</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/reference/configuration">Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/reference/json-schema-json-paths">JSON Schema and JSON Paths</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/reference/html-forms">HTML Form Parser</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/reference/api">REST API</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Command Line Interface (CLI)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos">kratos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-courier">kratos courier</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-courier-watch">kratos courier watch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-hashers">kratos hashers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-hashers-argon2">kratos hashers argon2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-hashers-argon2-calibrate">kratos hashers argon2 calibrate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities">kratos identities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities-delete">kratos identities delete</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities-get">kratos identities get</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities-import">kratos identities import</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities-list">kratos identities list</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities-patch">kratos identities patch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities-validate">kratos identities validate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-jsonnet">kratos jsonnet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-jsonnet-format">kratos jsonnet format</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-jsonnet-lint">kratos jsonnet lint</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-migrate">kratos migrate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-migrate-sql">kratos migrate sql</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-remote">kratos remote</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-remote-status">kratos remote status</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-remote-version">kratos remote version</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-serve">kratos serve</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-version">kratos version</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">items</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos">kratos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-hashers">kratos hashers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-hashers-argon2">kratos hashers argon2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-hashers-argon2-calibrate">kratos hashers argon2 calibrate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities">kratos identities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities-delete">kratos identities delete</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities-get">kratos identities get</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities-import">kratos identities import</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities-list">kratos identities list</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities-patch">kratos identities patch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-identities-validate">kratos identities validate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-jsonnet">kratos jsonnet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-jsonnet-format">kratos jsonnet format</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-jsonnet-lint">kratos jsonnet lint</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-migrate">kratos migrate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-migrate-sql">kratos migrate sql</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-remote">kratos remote</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-remote-status">kratos remote status</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-remote-version">kratos remote version</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-serve">kratos serve</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/cli/kratos-version">kratos version</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Debug &amp; Help</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/debug/csrf">Common Cookie and CSRF Pitfalls</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/debug/performance-out-of-memory-password-hashing-argon2">Performance Problems and Out Of Memory Panics Caused by Password Hashing</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">SDKs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/sdk">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Development</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/milestones">Milestones and Roadmap</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Further Reading</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/further-reading/comparison">Comparison</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/kratos/docs/next/further-reading/kratos-video-tutorials">Video Tutorials</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ORY Hydra</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/hydra" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/hydra/docs" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/ory/hydra" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">GitHub</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ORY Oathkeeper</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/oathkeeper" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/oathkeeper/docs" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/ory/oathkeeper" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">GitHub</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ORY Keto</a><ul class="menu__list"><li class="menu__list-item"><a href="https://www.ory.sh/keto" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">Home</a></li><li class="menu__list-item"><a href="https://www.ory.sh/keto/docs" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/ory/keto" target="_blank" rel="noreferrer noopener" class="menu__link" tabindex="-1">GitHub</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for ORY Kratos <strong>Next</strong> version.</div><div class="margin-top--md">For up-to-date documentation, see the <strong><a href="/kratos/docs/guides/sign-in-with-github-google-facebook-linkedin">latest version</a></strong> (v0.5).</div></div><div class="docItemContainer_a7m4"><article><div><span class="badge badge--secondary">Version: Next</span></div><header><h1 class="docTitle_Oumm">Sign in with GitHub, GitLab, Google, Facebook, LinkedIn, Microsoft ...</h1></header><div class="markdown"><p>In this document we will take a look at setting up &quot;Sign in with GitHub&quot; using
ORY Kratos.</p><p>Run the <a href="/kratos/docs/next/quickstart">Quickstart</a> with Docker Compose:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># This assumes that you have ORY Kratos checked out locally and</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># that your current directory (&quot;pwd&quot;) is the folder where ORY Kratos</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># is.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> quickstart</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>It is very important to add the &quot;session&quot; hook to the after oidc registration
hooks. Otherwise your users need to use the login flow again to be able to get a
session.</p><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">path/to/my/kratos/config.yml</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yaml codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># $ kratos -c path/to/my/kratos/config.yml serve</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">selfservice</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">flows</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">registration</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">after</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">oidc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">hooks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">hook</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> session</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="discord"></a>Discord<a class="hash-link" href="#discord" title="Direct link to heading">#</a></h2><p>To set up &quot;Sign in with Discord&quot; you must create a
<a href="https://discord.com/developers/docs/topics/oauth2" target="_blank" rel="noopener noreferrer">Discord OAuth2 Application</a>.</p><p>Set the &quot;Redirect URI&quot; to:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">http://127.0.0.1:4433/self-service/methods/oidc/callback/discord</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The pattern of this URL is:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">http(s)://&lt;domain-of-ory-kratos&gt;:&lt;public-port&gt;/self-service/methods/oidc/callback/&lt;provider-id&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The provider ID must point to the provider&#x27;s ID set in the ORY Kratos
configuration file (explained in further detail at
<a href="/kratos/docs/next/concepts/credentials/openid-connect-oidc-oauth2">OpenID Connect and OAuth2 Credentials</a>).</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Discord does not implement OpenID Connect. Therefore, ORY Kratos makes a request
to
<a href="https://discord.com/developers/docs/resources/user#get-current-user" target="_blank" rel="noopener noreferrer">Discord&#x27;s User API</a>
and adds that data to <code>std.extVar(&#x27;claims&#x27;)</code>. However, not all fields are
supported. Check the list of supported fields
<a href="https://github.com/ory/kratos/blob/v0.5.1-alpha.1/selfservice/strategy/oidc/provider_discord.go#L81-L91" target="_blank" rel="noopener noreferrer">in Kratos&#x27; source code</a>.</p><p>The <code>identify</code> scope will add following fields:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-text codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">iss                 # always https://discord.com/api/v6/oauth2/</span></div><div class="token-line" style="color:#393A34"><span class="token plain">sub                 # numeric discord user id</span></div><div class="token-line" style="color:#393A34"><span class="token plain">name                # username + # + discriminator</span></div><div class="token-line" style="color:#393A34"><span class="token plain">nickname            # username</span></div><div class="token-line" style="color:#393A34"><span class="token plain">preferred_username  # username</span></div><div class="token-line" style="color:#393A34"><span class="token plain">picture             # avatar url</span></div><div class="token-line" style="color:#393A34"><span class="token plain">locale              # user locale</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Additionally, the <code>email</code> scope will add:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-text codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">email               # user email</span></div><div class="token-line" style="color:#393A34"><span class="token plain">email_verified      # whether email is verified</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></div><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">contrib/quickstart/kratos/email-password/oidc.discord.jsonnet</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-json codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">local claims = </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  email_verified</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> + std.extVar(&#x27;claims&#x27;);</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  identity</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    traits</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Allowing unverified email addresses enables account</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// enumeration attacks, especially if the value is used for</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// e.g. verification or as a password login identifier.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Therefore we only return the email if it (a) exists and (b) is marked verified</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// by Discord.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">if </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token plain"> in claims &amp;&amp; claims.email_verified then </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token plain"> else </span><span class="token null keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> claims.email</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Now, enable the Discord provider in the ORY Kratos config located at
<code>&lt;kratos-directory&gt;/contrib/quickstart/kratos/email-password/.kratos.yml</code>.</p><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">contrib/quickstart/kratos/email-password/.kratos.yml</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yaml codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># $ kratos -c path/to/my/kratos/config.yml serve</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">selfservice</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">methods</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">oidc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">providers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> discord </span><span class="token comment" style="color:#999988;font-style:italic"># this is `&lt;provider-id&gt;` in the Authorization callback URL. DO NOT CHANGE IT ONCE SET!</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">provider</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> discord</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">client_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">. </span><span class="token comment" style="color:#999988;font-style:italic"># Replace this with the OAuth2 Client ID provided by Discord</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">client_secret</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">. </span><span class="token comment" style="color:#999988;font-style:italic"># Replace this with the OAuth2 Client Secret provided by Discord</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">mapper_url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">///etc/config/kratos/oidc.discord.jsonnet</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">scope</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> identify</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> email</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Discord is now an option to log in via Kratos.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="slack"></a>Slack<a class="hash-link" href="#slack" title="Direct link to heading">#</a></h2><p>To set up &quot;Sign in with Slack&quot; you must create a
<a href="https://api.slack.com/apps" target="_blank" rel="noopener noreferrer">Slack OAuth Application</a>.</p><p>Set the &quot;Redirect URI&quot; to:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">http://127.0.0.1:4433/self-service/methods/oidc/callback/slack</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The pattern of this URL is:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">http(s)://&lt;domain-of-ory-kratos&gt;:&lt;public-port&gt;/self-service/methods/oidc/callback/&lt;provider-id&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The provider ID must point to the provider&#x27;s ID set in the ORY Kratos
configuration file (explained in further detail at
<a href="/kratos/docs/next/concepts/credentials/openid-connect-oidc-oauth2">OpenID Connect and OAuth2 Credentials</a>).</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Slack does not implement OpenID Connect. Therefore, ORY Kratos makes a request
to <a href="https://api.slack.com/methods/users.identity" target="_blank" rel="noopener noreferrer">Slack&#x27;s Oauth2 API</a> and adds
that data to <code>std.extVar(&#x27;claims&#x27;)</code>. However, not all fields are supported.
Check the list of supported fields
<a href="https://github.com/ory/kratos/blob/master/selfservice/strategy/oidc/provider_slack.go" target="_blank" rel="noopener noreferrer">in Kratos&#x27; source code</a>.</p><p>The <code>identity.basic</code> scope will add following fields:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-text codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">iss                 # always https://slack.com/oauth/</span></div><div class="token-line" style="color:#393A34"><span class="token plain">sub                 # alphanumeric slack user id</span></div><div class="token-line" style="color:#393A34"><span class="token plain">name                # username</span></div><div class="token-line" style="color:#393A34"><span class="token plain">nickname            # username</span></div><div class="token-line" style="color:#393A34"><span class="token plain">preferred_username  # username</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Additionally, the <code>identity.email</code> scope will add:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-text codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">email               # user email</span></div><div class="token-line" style="color:#393A34"><span class="token plain">email_verified      # always true</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Additionally, the <code>identity.avatar</code> scope will add:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-text codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">picture             # user avatar (512x512px)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></div><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">contrib/quickstart/kratos/email-password/oidc.discord.jsonnet</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-json codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">local claims = </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  email_verified</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> + std.extVar(&#x27;claims&#x27;);</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  identity</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    traits</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Allowing unverified email addresses enables account</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// enumeration attacks, especially if the value is used for</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// e.g. verification or as a password login identifier.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// It is assumed that Slack requires a email to be verifed before accessable via Oauth (because they don&#x27;t provide a email_verified field).</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      email</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> claims.email</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Now, enable the Slack provider in the ORY Kratos config located at
<code>&lt;kratos-directory&gt;/contrib/quickstart/kratos/email-password/.kratos.yml</code>.</p><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">contrib/quickstart/kratos/email-password/.kratos.yml</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yaml codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># $ kratos -c path/to/my/kratos/config.yml serve</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">selfservice</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">methods</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">oidc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">providers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> slack </span><span class="token comment" style="color:#999988;font-style:italic"># this is `&lt;provider-id&gt;` in the Authorization callback URL. DO NOT CHANGE IT ONCE SET!</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">provider</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> slack</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">client_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">. </span><span class="token comment" style="color:#999988;font-style:italic"># Replace this with the OAuth2 Client ID provided by Slack</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">client_secret</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">. </span><span class="token comment" style="color:#999988;font-style:italic"># Replace this with the OAuth2 Client Secret provided by Slack</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">mapper_url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">///etc/config/kratos/oidc.slack.jsonnet</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">scope</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> identity.basic</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> identity.email</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Slack is now an option to log in via Kratos.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="github"></a>GitHub<a class="hash-link" href="#github" title="Direct link to heading">#</a></h2><iframe width="560" height="315" src="https://www.youtube.com/embed/Hz_dP5c_qvc" frameborder="0"></iframe><p>To set up &quot;Sign in with GitHub&quot; you must create a
<a href="https://developer.github.com/apps/building-oauth-apps/creating-an-oauth-app/" target="_blank" rel="noopener noreferrer">GitHub OAuth2 Client</a>.</p><p>Set the &quot;Authorization callback URL&quot; to:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">http://127.0.0.1:4433/self-service/methods/oidc/callback/github</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The pattern of this URL is:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">http(s)://&lt;domain-of-ory-kratos&gt;:&lt;public-port&gt;//self-service/methods/oidc/callback/&lt;provider-id&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The provider ID must point to the provider&#x27;s ID set in the ORY Kratos
configuration file (explained in further detail at
<a href="/kratos/docs/next/concepts/credentials/openid-connect-oidc-oauth2">OpenID Connect and OAuth2 Credentials</a>).</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>GitHub does not implement OpenID Connect. Therefore, ORY Kratos makes a request
to
<a href="https://developer.github.com/v3/users/#get-the-authenticated-user" target="_blank" rel="noopener noreferrer">GitHub&#x27;s User API</a>
and adds that data to <code>std.extVar(&#x27;claims&#x27;)</code>. Check out what data is available
at
<a href="https://developer.github.com/apps/building-oauth-apps/understanding-scopes-for-oauth-apps/" target="_blank" rel="noopener noreferrer">GitHub&#x27;s Scope Docs</a>.
Not all GitHub fields are supported however. Check the list of supported fields
<a href="https://github.com/ory/kratos/blob/v0.2.1-alpha.1/selfservice/strategy/oidc/provider_github.go#L72-L98" target="_blank" rel="noopener noreferrer">in Kratos&#x27; source code</a>.</p></div></div><p>As explained in
<a href="/kratos/docs/next/concepts/credentials/openid-connect-oidc-oauth2">OpenID Connect and OAuth2 Credentials</a>,
you must also create a Jsonnet code snippet for the provider. Save the code in
<code>&lt;kratos-directory&gt;/contrib/quickstart/kratos/email-password/oidc.github.jsonnet</code>.
The following JsonNet takes <code>email_primary</code> and maps it to <code>traits.email</code>:</p><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">contrib/quickstart/kratos/email-password/oidc.github.jsonnet</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-json codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">local claims = </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  email_verified</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> + std.extVar(&#x27;claims&#x27;);</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  identity</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    traits</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Allowing unverified email addresses enables account</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// enumeration attacks, especially if the value is used for</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// e.g. verification or as a password login identifier.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Therefore we only return the email if it (a) exists and (b) is marked verified</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// by GitHub.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">if </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token plain"> in claims &amp;&amp; claims.email_verified then </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token plain"> else </span><span class="token null keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> claims.email</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Now, enable the GitHub provider in the ORY Kratos config located at
<code>&lt;kratos-directory&gt;/contrib/quickstart/kratos/email-password/.kratos.yml</code>.</p><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">contrib/quickstart/kratos/email-password/.kratos.yml</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yaml codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># $ kratos -c path/to/my/kratos/config.yml serve</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">selfservice</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">methods</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">oidc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">providers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> github </span><span class="token comment" style="color:#999988;font-style:italic"># this is `&lt;provider-id&gt;` in the Authorization callback URL. DO NOT CHANGE IT ONCE SET!</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">provider</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> github</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">client_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">. </span><span class="token comment" style="color:#999988;font-style:italic"># Replace this with the OAuth2 Client ID provided by GitHub</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">client_secret</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">. </span><span class="token comment" style="color:#999988;font-style:italic"># Replace this with the OAuth2 Client Secret provided by GitHub</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">mapper_url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">///etc/config/kratos/oidc.github.jsonnet</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">scope</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">email</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Next, open the login endpoint of the SecureApp and you should see the GitHub
Login option!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="gitlab"></a>GitLab<a class="hash-link" href="#gitlab" title="Direct link to heading">#</a></h2><p>To set up &quot;Sign in with GitLab&quot; you must create a
<a href="https://docs.gitlab.com/ee/integration/oauth_provider.html#adding-an-application-through-the-profile" target="_blank" rel="noopener noreferrer">GitLab OAuth2 Application</a>.</p><p>Set the &quot;Redirect URI&quot; to:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">http://127.0.0.1:4433/self-service/methods/oidc/callback/gitlab</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The pattern of this URL is:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">http(s)://&lt;domain-of-ory-kratos&gt;:&lt;public-port&gt;/self-service/methods/oidc/callback/&lt;provider-id&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>While you can use
<a href="https://docs.gitlab.com/ee/integration/openid_connect_provider.html" target="_blank" rel="noopener noreferrer">GitLab as an OIDC identity provider</a>,
GitLab only returns the sub and sub_legacy claims in the ID token. Therefore,
ORY Kratos makes a request to
<a href="https://gitlab.com/oauth/userinfo" target="_blank" rel="noopener noreferrer">GitLab&#x27;s /oauth/userinfo API</a> and adds the
user info to <code>std.extVar(&#x27;claims&#x27;)</code>.</p></div></div><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">contrib/quickstart/kratos/email-password/oidc.gitlab.jsonnet</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-json codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">local claims = </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  email_verified</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> + std.extVar(&#x27;claims&#x27;);</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  identity</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    traits</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Allowing unverified email addresses enables account</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// enumeration attacks, especially if the value is used for</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// e.g. verification or as a password login identifier.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Therefore we only return the email if it (a) exists and (b) is marked verified</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// by GitLab.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">if </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token plain"> in claims &amp;&amp; claims.email_verified then </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token plain"> else </span><span class="token null keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> claims.email</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Now, enable the GitLab provider in the ORY Kratos config located at
<code>&lt;kratos-directory&gt;/contrib/quickstart/kratos/email-password/.kratos.yml</code>.</p><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">contrib/quickstart/kratos/email-password/.kratos.yml</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yaml codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># $ kratos -c path/to/my/kratos/config.yml serve</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">selfservice</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">methods</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">oidc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">providers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gitlab </span><span class="token comment" style="color:#999988;font-style:italic"># this is `&lt;provider-id&gt;` in the Authorization callback URL. DO NOT CHANGE IT ONCE SET!</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">provider</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gitlab</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">client_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">. </span><span class="token comment" style="color:#999988;font-style:italic"># Replace this with the OAuth2 Client ID provided by GitLab</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">client_secret</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">. </span><span class="token comment" style="color:#999988;font-style:italic"># Replace this with the OAuth2 Client Secret provided by GitLab</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">mapper_url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">///etc/config/kratos/oidc.gitlab.jsonnet</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">scope</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> read_user</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> openid</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> profile</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> email</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>GitLab is now an option to log in via Kratos.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="microsoft"></a>Microsoft<a class="hash-link" href="#microsoft" title="Direct link to heading">#</a></h2><p>This will enable you to log in using any Azure AD directory - Multitenant and
personal Microsoft accounts (e.g. Skype, Xbox) depending on the settings made
when creating the application in Azure AD.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="creating-an-application-in-azure-ad"></a>Creating an Application in Azure AD<a class="hash-link" href="#creating-an-application-in-azure-ad" title="Direct link to heading">#</a></h4><p>To set up &quot;Sign in with Microsoft&quot; you must first
<a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app" target="_blank" rel="noopener noreferrer">register an application with the Microsoft identity platform</a>.</p><p>Select &quot;Web&quot; as the &quot;Redirect URI&quot; type, and set the URI to:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">http(s)://&lt;domain-of-ory-kratos&gt;:&lt;public-port&gt;//self-service/methods/oidc/callback/&lt;provider-id&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>After the &quot;App Registration&quot; is created, make note of the <code>Application ID</code> and
<code>Directory ID</code> on top of the Overview page. To create the client secret,
navigate to &quot;Certificates &amp; secrets&quot; and click &quot;+ New client secret&quot;. Remember
to copy the secret value as it will only be shown once.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="configuring-kratos"></a>Configuring Kratos<a class="hash-link" href="#configuring-kratos" title="Direct link to heading">#</a></h4><p>Create a Jsonnet claims mapper as described in
<a href="/kratos/docs/next/concepts/credentials/openid-connect-oidc-oauth2">OpenID Connect and OAuth2 Credentials</a>.
Save the code in
<code>&lt;kratos-directory&gt;/contrib/quickstart/kratos/email-password/oidc.microsoft.jsonnet</code>.</p><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">contrib/quickstart/kratos/email-password/oidc.microsoft.jsonnet</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-json codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">local claims = std.extVar(&#x27;claims&#x27;);</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  identity</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    traits</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Allowing unverified email addresses enables account</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// enumeration attacks, especially if the value is used for</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// e.g. verification or as a password login identifier.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// If connecting only to your organization (one tenant), claims.email is safe to use if you have not actively disabled e-mail verification during signup.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// The email might be empty if the account is not linked to an email address.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// For a human readable identifier, consider using the </span><span class="token string" style="color:#e3116c">&quot;preferred_username&quot;</span><span class="token plain"> claim.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">if </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token plain"> in claims then </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token plain"> else </span><span class="token null keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> claims.email</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Enable the Microsoft provider in the ORY Kratos config located at
<code>&lt;kratos-directory&gt;/contrib/quickstart/kratos/email-password/.kratos.yml</code>.</p><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">contrib/quickstart/kratos/email-password/.kratos.yml</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yaml codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">selfservice</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">methods</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">oidc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">providers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> microsoft </span><span class="token comment" style="color:#999988;font-style:italic"># this is `&lt;provider-id&gt;` in the Authorization callback URL. DO NOT CHANGE IT ONCE SET!</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">provider</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> microsoft</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">client_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">. </span><span class="token comment" style="color:#999988;font-style:italic"># Replace this with the Application ID from the App Registration</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">client_secret</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">. </span><span class="token comment" style="color:#999988;font-style:italic"># Replace this with the generated Secret value from the App Registration</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">tenant</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">. </span><span class="token comment" style="color:#999988;font-style:italic"># Replace this with the Tenant of your choice (see below)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">mapper_url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">///etc/config/kratos/oidc.microsoft.jsonnet</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">scope</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> profile</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> email</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Azure AD is now an option to log in to kratos.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor" id="choosing-tenant"></a>Choosing Tenant<a class="hash-link" href="#choosing-tenant" title="Direct link to heading">#</a></h5><p>There are two ways to use the <code>microsoft</code> provider for authentication:</p><ol><li>For authenticating users in a single Azure AD Directory (organisation), set
the <code>tenant</code> value to either the <code>Directory ID</code> from the &quot;App Registration&quot;
page, or the organisation domain. E.g. <code>8eaef023-2b34-4da1-9baa-8bc8c9d6a490</code>
or <code>contoso.onmicrosoft.com</code>.</li><li>For authenticating any user in the Microsoft identity platform, set the
<code>tenant</code> value to either:</li></ol><ul><li><code>organizations</code> to allow users with work or school accounts, or</li><li><code>consumers</code> to allow users with personal accounts, or</li><li><code>common</code> to allow both kind of accounts.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="twitch"></a>Twitch<a class="hash-link" href="#twitch" title="Direct link to heading">#</a></h2><p>To set up &quot;Sign in with Twitch&quot; you must create a
<a href="https://dev.twitch.tv/docs/authentication#registration" target="_blank" rel="noopener noreferrer">Twitch OAuth2 Application</a>.</p><p>Set the &quot;Redirect URI&quot; to:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">http://127.0.0.1:4433/self-service/methods/oidc/callback/twitch</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The pattern of this URL is:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">http(s)://&lt;domain-of-ory-kratos&gt;:&lt;public-port&gt;/self-service/methods/oidc/callback/&lt;provider-id&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The provider ID must point to the provider&#x27;s ID set in the ORY Kratos
configuration file (explained in further detail at
<a href="/kratos/docs/next/concepts/credentials/openid-connect-oidc-oauth2">OpenID Connect and OAuth2 Credentials</a>).</p><p>As explained in
<a href="/kratos/docs/next/concepts/credentials/openid-connect-oidc-oauth2">OpenID Connect and OAuth2 Credentials</a>,
you must also create a Jsonnet code snippet for the provider. Save the code in
<code>&lt;kratos-directory&gt;/contrib/quickstart/kratos/email-password/oidc.twitch.jsonnet</code>.</p><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">contrib/quickstart/kratos/email-password/oidc.twitch.jsonnet</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-json codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">local claims = </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  email_verified</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> + std.extVar(&#x27;claims&#x27;);</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  identity</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    traits</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Allowing unverified email addresses enables account</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// enumeration attacks, especially if the value is used for</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// e.g. verification or as a password login identifier.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Therefore we only return the email if it (a) exists and (b) is marked verified</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// by Twitch.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">if </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token plain"> in claims &amp;&amp; claims.email_verified then </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token plain"> else </span><span class="token null keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> claims.email</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Now, enable the Twitch provider in the ORY Kratos config located at
<code>&lt;kratos-directory&gt;/contrib/quickstart/kratos/email-password/.kratos.yml</code>.</p><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">contrib/quickstart/kratos/email-password/.kratos.yml</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yaml codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># $ kratos -c path/to/my/kratos/config.yml serve</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">selfservice</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">methods</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">oidc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">providers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> twitch </span><span class="token comment" style="color:#999988;font-style:italic"># this is `&lt;provider-id&gt;` in the Authorization callback URL. DO NOT CHANGE IT ONCE SET!</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">provider</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> generic</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">client_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">. </span><span class="token comment" style="color:#999988;font-style:italic"># Replace this with the OAuth2 Client ID provided by Twitch</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">client_secret</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">. </span><span class="token comment" style="color:#999988;font-style:italic"># Replace this with the OAuth2 Client Secret provided by Twitch</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">issuer_url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//id.twitch.tv/oauth2</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">mapper_url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">///etc/config/kratos/oidc.twitch.jsonnet</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">scope</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> openid</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">email </span><span class="token comment" style="color:#999988;font-style:italic"># required for email and email_verified claims in the near future</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">requested_claims</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># explicitly request email and email_verified claims because twitch doesn&#x27;t add them by default</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">id_token</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">email</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token key atrule" style="color:#00a4db">essential</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">email_verified</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token key atrule" style="color:#00a4db">essential</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Next, open the login endpoint of the SecureApp and you should see the Twitch
Login option!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="facebook"></a>Facebook<a class="hash-link" href="#facebook" title="Direct link to heading">#</a></h2><p><strong>Create Facebook Application</strong></p><p>To set up &quot;Sign in with Facebook&quot; you first need a
<a href="https://developers.facebook.com/docs/development/register" target="_blank" rel="noopener noreferrer">Facebook Developer Account</a>.</p><p>Create a
<a href="https://developers.facebook.com/docs/development/create-an-app" target="_blank" rel="noopener noreferrer">Facebook OAuth2 Application</a>.</p><p>Add a &quot;Facebook Login&quot; product to this application.</p><p>Select &quot;Settings&quot; in the Products menu.</p><p>Set the &quot;Valid OAuth Redirect URIs&quot; to:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">https://127.0.0.1:4433/self-service/methods/oidc/callback/facebook</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The pattern of this URL is:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">https://&lt;domain-of-ory-kratos&gt;:&lt;public-port&gt;/self-service/methods/oidc/callback/&lt;provider-id&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Facebook requires https the redirect URIs!</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>While you can use
<a href="https://developers.facebook.com/docs/facebook-login/" target="_blank" rel="noopener noreferrer">Facebook as an OIDC identity provider</a>,
Facebook only returns access_token and not id_token. Therefore, ORY Kratos makes
a request to
<a href="https://graph.facebook.com/me" target="_blank" rel="noopener noreferrer">Facebook&#x27;s graph.facebook.com/me API</a> and adds
the user info to <code>std.extVar(&#x27;claims&#x27;)</code>.</p></div></div><p><strong>Configuring Kratos</strong></p><p>Create a Jsonnet claims mapper as described in
<a href="/kratos/docs/next/concepts/credentials/openid-connect-oidc-oauth2">OpenID Connect and OAuth2 Credentials</a>.
Save the code in
<code>&lt;kratos-directory&gt;/contrib/quickstart/kratos/email-password/oidc.facebook.jsonnet</code>.</p><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">contrib/quickstart/kratos/email-password/oidc.facebook.jsonnet</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-json codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">local claims = std.extVar(&#x27;claims&#x27;);</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  identity</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    traits</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Allowing unverified email addresses enables account</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// enumeration attacks, especially if the value is used for</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// e.g. verification or as a password login identifier.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// It is assumed that Facebook requires a email to be verifed before accessable via Oauth (because they don&#x27;t provide an email_verified field).</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// The email might be empty if the user is not allowed to an email scope.</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">if </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token plain"> in claims then </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token plain"> else </span><span class="token null keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> claims.email</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Now, enable the Facebook provider in the ORY Kratos config located at
<code>&lt;kratos-directory&gt;/contrib/quickstart/kratos/email-password/kratos.yml</code>.</p><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">contrib/quickstart/kratos/email-password/kratos.yml</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yaml codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># $ kratos -c path/to/my/kratos/config.yml serve</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">selfservice</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">methods</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">oidc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">providers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> facebook </span><span class="token comment" style="color:#999988;font-style:italic"># this is `&lt;provider-id&gt;` in the Authorization callback URL. DO NOT CHANGE IT ONCE SET!</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">provider</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> facebook</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">client_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">. </span><span class="token comment" style="color:#999988;font-style:italic"># Replace this with the OAuth2 Client ID provided by Facebook app</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">client_secret</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">. </span><span class="token comment" style="color:#999988;font-style:italic"># Replace this with the OAuth2 Client Secret provided by Facebook app</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">mapper_url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">///etc/config/kratos/oidc.facebook.jsonnet</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">scope</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> email </span><span class="token comment" style="color:#999988;font-style:italic"># required for email and email_verified claims in the near future</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic"># other supported scopes: user_gender, user_birthday</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Next, open the login endpoint of the SecureApp and you should see the Facebook
Login option!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="google"></a>Google<a class="hash-link" href="#google" title="Direct link to heading">#</a></h2><p><strong>Set up on Google Cloud Platform</strong></p><ol><li>Create an
<a href="https://console.cloud.google.com/apis/credentials/consent" target="_blank" rel="noopener noreferrer">OAuth consent screen</a></li><li>Create
<a href="https://console.cloud.google.com/apis/credentials" target="_blank" rel="noopener noreferrer">OAuth 2.0 Client IDs</a></li></ol><p>In the new <em>OAuth 2.0 Client ID</em>, you will need the <code>Client ID</code> and
<code>Client secret</code>.</p><p><strong>Configuring Kratos</strong></p><p>Create a Jsonnet claims mapper as described in
<a href="/kratos/docs/next/concepts/credentials/openid-connect-oidc-oauth2">OpenID Connect and OAuth2 Credentials</a>.
Save the code in
<code>&lt;kratos-directory&gt;/contrib/quickstart/kratos/email-password/oidc.google.jsonnet</code>.</p><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">contrib/quickstart/kratos/email-password/oidc.google.jsonnet</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-json codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">local claims = </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  email_verified</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> + std.extVar(&#x27;claims&#x27;);</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  identity</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    traits</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">if </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token plain"> in claims &amp;&amp; claims.email_verified then </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token plain"> else </span><span class="token null keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> claims.email</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// additional claims</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// please also see the `Google specific claims` section</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      first_name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> claims.given_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      last_name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> claims.family_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">if </span><span class="token string" style="color:#e3116c">&quot;hd&quot;</span><span class="token plain"> in claims &amp;&amp; claims.email_verified then </span><span class="token string" style="color:#e3116c">&quot;hd&quot;</span><span class="token plain"> else </span><span class="token null keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> claims.hd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Now, enable the Google provider in the ORY Kratos config located at
<code>&lt;kratos-directory&gt;/contrib/quickstart/kratos/email-password/.kratos.yml</code>.</p><div class="mdxCodeBlock_1zKU"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2eSY">contrib/quickstart/kratos/email-password/kratos.yml</div><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yaml codeBlock_tuNs thin-scrollbar codeBlockWithTitle_1UkA"><div class="codeBlockLines_3uvA" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># $ kratos -c path/to/my/kratos/config.yml serve</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">selfservice</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">methods</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">oidc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">providers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> google </span><span class="token comment" style="color:#999988;font-style:italic"># this is `&lt;provider-id&gt;` in the Authorization callback URL. DO NOT CHANGE IT ONCE SET!</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">provider</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> google</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">client_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">. </span><span class="token comment" style="color:#999988;font-style:italic"># Replace this with the OAuth2 Client ID</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">client_secret</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain">. </span><span class="token comment" style="color:#999988;font-style:italic"># Replace this with the OAuth2 Client secret</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">mapper_url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">///etc/config/kratos/oidc.google.jsonnet</span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">scope</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> email</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> profile</span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token comment" style="color:#999988;font-style:italic"># other supported scopes can be found in Google OAuth 2.0 dev docs</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">requested_claims</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">id_token</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">email</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token key atrule" style="color:#00a4db">essential</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">email_verified</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token key atrule" style="color:#00a4db">essential</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">given_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token key atrule" style="color:#00a4db">essential</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">family_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token null important">null</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">hd</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token null important">null </span><span class="token comment" style="color:#999988;font-style:italic"># If you want the G Suite domain</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Google specific claims</strong></p><ul><li><code>hd</code>: The hosted G Suite domain of the user. Provided only if the user belongs
to a hosted domain. For a given email account with custom domain
<code>example.com</code> - <code>user1@example.com</code> would produce <code>example.com</code> in the <code>hd</code>
claim.</li></ul><p>Please look at the Google developer documentation which can be found
<a href="https://developers.google.com/identity/protocols/oauth2/openid-connect#an-id-tokens-payload" target="_blank" rel="noopener noreferrer">here</a>
.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="linkedin"></a>LinkedIn<a class="hash-link" href="#linkedin" title="Direct link to heading">#</a></h2><p>Connecting with other Social Sign In providers will be very similar to the
GitHub flow. If you&#x27;ve managed to do it, add to this document by writing it down
and making a PR! :)</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/ory/kratos/edit/master/docs/docs/guides/sign-in-with-github-google-facebook-linkedin.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2021-03-02T16:41:55.000Z" class="docLastUpdatedAt_1Qna">3/2/2021</time> by <strong>Alano Terblanche</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/kratos/docs/next/admin/managing-users-identities"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Managing Users and Identities</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/kratos/docs/next/guides/login-session"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configuring And Checking for Login Sessions Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#discord" class="table-of-contents__link">Discord</a></li><li><a href="#slack" class="table-of-contents__link">Slack</a></li><li><a href="#github" class="table-of-contents__link">GitHub</a></li><li><a href="#gitlab" class="table-of-contents__link">GitLab</a></li><li><a href="#microsoft" class="table-of-contents__link">Microsoft</a></li><li><a href="#twitch" class="table-of-contents__link">Twitch</a></li><li><a href="#facebook" class="table-of-contents__link">Facebook</a></li><li><a href="#google" class="table-of-contents__link">Google</a></li><li><a href="#linkedin" class="table-of-contents__link">LinkedIn</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Company</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.ory.sh/imprint" target="_blank" rel="noopener noreferrer" class="footer__link-item">Imprint</a></li><li class="footer__item"><a href="https://www.ory.sh/privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://www.ory.sh/tos" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2021 ORY GmbH</div></div></div></footer></div>
<script src="/kratos/docs/styles.f323bf4b.js"></script>
<script src="/kratos/docs/runtime~main.19a413eb.js"></script>
<script src="/kratos/docs/main.001eb6bc.js"></script>
<script src="/kratos/docs/2.23b0993d.js"></script>
<script src="/kratos/docs/3.534471af.js"></script>
<script src="/kratos/docs/18b93cb3.ba3604b6.js"></script>
<script src="/kratos/docs/1be78505.d49740a9.js"></script>
<script src="/kratos/docs/375.1a250f46.js"></script>
<script src="/kratos/docs/b8d7c5e6.387dfc0a.js"></script>
<script src="/kratos/docs/935f2afb.21b0d5f6.js"></script>
<script src="/kratos/docs/374.add71109.js"></script>
<script src="/kratos/docs/1997122c.b72ffe89.js"></script>
<noscript><p><img src="//sqa-web.ory.sh/np.php?idsite=2&amp;rec=1" style="border:0;" alt=""></p></noscript></body>
</html>