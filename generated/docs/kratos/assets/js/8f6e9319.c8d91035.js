(window.webpackJsonp=window.webpackJsonp||[]).push([[255],{323:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return s})),n.d(t,"toc",(function(){return c})),n.d(t,"default",(function(){return u}));var r=n(3),o=n(8),a=(n(0),n(552)),i={id:"hosting-own-have-i-been-pwned-api",title:"Hosting own Have I Been Pwned API"},s={unversionedId:"guides/hosting-own-have-i-been-pwned-api",id:"guides/hosting-own-have-i-been-pwned-api",isDocsHomePage:!1,title:"Hosting own Have I Been Pwned API",description:"Ory Kratos uses the Have I Been Pwned (HiBP) API, with the k-anonymity flag, to",source:"@site/docs/guides/hosting-own-have-i-been-pwned-api.mdx",sourceDirName:"guides",slug:"/guides/hosting-own-have-i-been-pwned-api",permalink:"/kratos/docs/next/guides/hosting-own-have-i-been-pwned-api",editUrl:"https://github.com/ory/kratos/edit/master/docs/docs/guides/hosting-own-have-i-been-pwned-api.mdx",version:"current",lastUpdatedBy:"Radek Gruchalski",lastUpdatedAt:1620724489,formattedLastUpdatedAt:"5/11/2021",frontMatter:{id:"hosting-own-have-i-been-pwned-api",title:"Hosting own Have I Been Pwned API"}},c=[],p={toc:c};function u(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(a.b)("wrapper",Object(r.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,"Ory Kratos uses the Have I Been Pwned (HiBP) API, with the k-anonymity flag, to\ncheck if the password the user registers with has been a part of one of the\nbreaches documented by the HiBP project."),Object(a.b)("p",null,"In some environments, due to various CISO policies, it might be difficult to\nestablish egress connectivity to non-approved hosts. If it happens that your\nKratos operates in such an environment and it cannot communicate with the HiBP\nAPI at haveibeenpwned.com, but there is the requirement to check if passwords\nhave been leaked, you can host the HiBP API yourself and configure Kratos to use\nyour own instance."),Object(a.b)("p",null,"To do so, configure Kratos to use your API:"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-yaml",metastring:'title="path/to/kratos/config.yml',title:'"path/to/kratos/config.yml'},"selfservice:\n  methods:\n    password:\n      config:\n        haveibeenpwned_host: api.private.host\n")),Object(a.b)("p",null,"An example of a minimal self-hosted, k-anonymity enabled HiBP API\n",Object(a.b)("a",{parentName:"p",href:"https://github.com/radekg/hibp"},"can be found in this repository"),"."),Object(a.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(a.b)("div",{parentName:"div",className:"admonition-heading"},Object(a.b)("h5",{parentName:"div"},Object(a.b)("span",{parentName:"h5",className:"admonition-icon"},Object(a.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(a.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(a.b)("div",{parentName:"div",className:"admonition-content"},Object(a.b)("p",{parentName:"div"},"Ory Kratos ",Object(a.b)("inlineCode",{parentName:"p"},"haveibeenpwned_host")," setting does not allow configuring the\nrespective CA chain at the moment but it ",Object(a.b)("strong",{parentName:"p"},"does require a TLS connection"),".\nTherefore your private HiBP API must use one of the trusted CAs of the\nunderlying operating system."),Object(a.b)("p",{parentName:"div"},"A solution might be to host the HiBP API using a certificate issued by Let's\nEncrypt certificate or install the private CA certificate in the trusted CA\ncertificates of the system on which Kratos is running."))))}u.isMDXComponent=!0},552:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return b}));var r=n(0),o=n.n(r);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=o.a.createContext({}),u=function(e){var t=o.a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},d=function(e){var t=u(e.components);return o.a.createElement(p.Provider,{value:t},e.children)},l={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},h=o.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,i=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),d=u(n),h=r,b=d["".concat(i,".").concat(h)]||d[h]||l[h]||a;return n?o.a.createElement(b,s(s({ref:t},p),{},{components:n})):o.a.createElement(b,s({ref:t},p))}));function b(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=h;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var p=2;p<a;p++)i[p]=n[p];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,n)}h.displayName="MDXCreateElement"}}]);