(self.webpackChunkdocusaurus_template=self.webpackChunkdocusaurus_template||[]).push([[3870],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return p},kt:function(){return h}});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(n),h=a,m=u["".concat(l,".").concat(h)]||u[h]||d[h]||i;return n?r.createElement(m,o(o({ref:t},p),{},{components:n})):r.createElement(m,o({ref:t},p))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var c=2;c<i;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},32527:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(67294),a=n(21140),i=n.n(a),o="graph_1lrJ",s="pointer_3d8u",l="overlay_2fuY",c="visible_2Z3U",p="backdrop_2z5L",d=n(94184),u=n.n(d);i().initialize({startOnLoad:!0,logLevel:"fatal",securityLevel:"strict",arrowMarkerAbsolute:!1,theme:"neutral",flowchart:{useMaxWidth:!0,htmlLabels:!0,rankSpacing:65,nodeSpacing:30,curve:"basis"},sequence:{useMaxWidth:!0},gantt:{useMaxWidth:!0}});var h=function(e){var t,n=e.chart,a=(0,r.useState)(!1),d=a[0],h=a[1],m=(0,r.useState)(void 0),f=m[0],y=m[1],g=(0,r.useState)("mermaid-"+Math.random().toString(36).substr(2,-1))[0],k=function(){return h(!d)};return(0,r.useEffect)((function(){i().render(g,n,(function(e){y(e)}))}),[]),r.createElement(r.Fragment,null,r.createElement("div",{onClick:k,className:u()(o,s),dangerouslySetInnerHTML:{__html:f}}),r.createElement("div",{onClick:k,className:u()(l,s,o,(t={},t[c]=d,t))},r.createElement("div",{onClick:function(e){return e.stopPropagation()},className:u()(p,o),dangerouslySetInnerHTML:{__html:f}})))}},71069:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return s},metadata:function(){return l},toc:function(){return c},default:function(){return d}});var r=n(22122),a=n(19756),i=(n(67294),n(3905)),o=n(32527),s={title:"Performance"},l={unversionedId:"performance",id:"version-v0.6/performance",isDocsHomePage:!1,title:"Performance",description:"This document explains the time complexity of Ory Keto. Main memory complexity",source:"@site/versioned_docs/version-v0.6/performance.mdx",sourceDirName:".",slug:"/performance",permalink:"/keto/docs/performance",editUrl:"https://github.com/ory/keto/edit/master/docs/versioned_docs/version-v0.6/performance.mdx",version:"v0.6",lastUpdatedBy:"Patrik",lastUpdatedAt:1620725654,formattedLastUpdatedAt:"5/11/2021",frontMatter:{title:"Performance"},sidebar:"version-v0.6/docs",previous:{title:"Implemented and Planned Features",permalink:"/keto/docs/implemented-planned-features"},next:{title:"Quickstart: Cat Videos Example",permalink:"/keto/docs/quickstart"}},c=[{value:"Check Engine",id:"check-engine",children:[]},{value:"Expand Engine",id:"expand-engine",children:[]},{value:"References",id:"references",children:[]}],p={toc:c};function d(e){var t=e.components,n=(0,a.Z)(e,["components"]);return(0,i.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"This document explains the time complexity of Ory Keto. Main memory complexity\nwill be analyzed and added at a later point. We only examine the evaluation\nengines (check- and expand-API) as all other parts are mainly determined by\ndependencies like your database of choice, or the de-/encoding of messages.\nExamples given omit the namespace for clarity."),(0,i.kt)("h2",{id:"check-engine"},"Check Engine"),(0,i.kt)("p",null,"In essence, the check-engine assumes that the relation tuples and their\nindirections assemble an acyclic directed graph, known as\n",(0,i.kt)("a",{parentName:"p",href:"concepts/graph-of-relations"},"the graph of relations"),"."),(0,i.kt)("p",null,"Consider the following example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-keto-relation-tuples"},"file#access@(file#owner)       // probably defined via subjectset rewrites\nfile#access@user1              // access was granted directly\nfile#owner@user2               // file owner record; indirectly gets access\n")),(0,i.kt)("p",null,"This is interpreted as the following graph:"),(0,i.kt)(o.Z,{chart:"\ngraph TD\n    A[file] --\x3e|access| B{{file#owner}}\n    A --\x3e|owner| C([user2])\n    A --\x3e|access| D([user1])\n    B -. file#access .-> C\n",mdxType:"Mermaid"}),(0,i.kt)("p",null,"A check request of the form ",(0,i.kt)("inlineCode",{parentName:"p"},"object#relation@user")," will be evaluated by\nsearching the graph starting at ",(0,i.kt)("inlineCode",{parentName:"p"},"object")," going through ",(0,i.kt)("inlineCode",{parentName:"p"},"relation")," trying to\nreach ",(0,i.kt)("inlineCode",{parentName:"p"},"user"),". The request is allowed iff there is such a path."),(0,i.kt)("p",null,"The algorithm used in Ory Keto for this graph traversal is breadth-first search.\nIn the worst case it has a time complexity of ",(0,i.kt)("inlineCode",{parentName:"p"},"O(n+e)")," where ",(0,i.kt)("inlineCode",{parentName:"p"},"n")," is the number\nof nodes reachable from the node ",(0,i.kt)("inlineCode",{parentName:"p"},"object#relation")," through ",(0,i.kt)("inlineCode",{parentName:"p"},"e")," edges. Space\ncomplexity is ",(0,i.kt)("inlineCode",{parentName:"p"},"O(n)"),". Rearranged, both space and time complexity are ",(0,i.kt)("inlineCode",{parentName:"p"},"O(b^d)"),"\nwhere ",(0,i.kt)("inlineCode",{parentName:"p"},"b")," is the maximum breadth and ",(0,i.kt)("inlineCode",{parentName:"p"},"d")," the maximum depth in the graph, seen\nfrom the search root. ",(0,i.kt)("a",{parentName:"p",href:"#references"},"[1]")),(0,i.kt)("p",null,"This means that the complexity heavily depends on the structure of the graph. If\nit contains deeply nested indirections, it will require many recursive calls to\nresolve those indirections. Analogously, if there are widely nested\nindirections, Ory Keto has to possibly resolve all of them. The goal is to\ndesign the ACL tuples in a way such that there are only view indirections to\nresolve. Learn more in our\n",(0,i.kt)("a",{parentName:"p",href:"/keto/docs/guides/access-control-list-design-best-practices"},"best practices around ACL design"),"."),(0,i.kt)("p",null,"Because of this we decided that generic benchmarks will not yield any meaningful\nresult. We will therefore add a comparison with other similar projects later on."),(0,i.kt)("h2",{id:"expand-engine"},"Expand Engine"),(0,i.kt)("p",null,"Similar to how the check-engine traverses the graph of relationtuples, the\nexpand-engine builds the tree of all set operations it encounters. It resolves\nall indirections starting at the requested subjectset up to the specified depth.\nBecause it also uses breadth-first search, time and space complexity linearly\ndepend on the nodes reachable from the requested subjectset. The same\nperformance considerations apply here, while it is important to note that\nrequesting a low depth will further limit the complexity of the operation. The\nreturned tree can also exceed reasonable size limits quickly if the\nrelationtuples are deeply and/or widely nested."),(0,i.kt)("h2",{id:"references"},"References"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Breadth-first_search"},"[1] Breadth-first search"),"\non Wikipedia"))}d.isMDXComponent=!0},11748:function(e,t,n){var r={"./locale":89234,"./locale.js":89234};function a(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=i,e.exports=a,a.id=11748}}]);